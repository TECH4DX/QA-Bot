[2022-09-10 17:14:45,647][__main__][INFO] - 
cwd: /home/zzx/deepke/DeepKE/example/re/standard
preprocess: true
data_path: data/origin
out_path: data/out
chinese_split: true
replace_entity_with_type: true
replace_entity_with_scope: true
min_freq: 3
pos_limit: 60
seed: 1
use_gpu: true
gpu_id: 0
epoch: 150
batch_size: 32
learning_rate: 0.0003
lr_factor: 0.7
lr_patience: 3
weight_decay: 0.001
early_stopping_patience: 6
train_log: true
log_interval: 10
show_plot: true
only_comparison_plot: false
plot_utils: matplot
predict_plot: false
vocab_size: ???
word_dim: 60
pos_size: 122
pos_dim: 10
dim_strategy: sum
num_relations: 14
fp: /home/zzx/deepke/DeepKE/example/re/standard/checkpoints/2022-09-05_15-16-06/lm_epoch150.pth
model_name: capsule
share_weights: true
num_iterations: 5
dropout: 0.3
input_dim_capsule: ???
dim_capsule: 50
num_capsule: ???
in_channels: ???
out_channels: 100
kernel_sizes:
- 9
activation: lrelu
keep_length: false
pooling_strategy: cls

[2022-09-10 17:14:50,945][__main__][INFO] - device: cuda:0
[2022-09-10 17:14:50,945][deepke.relation_extraction.standard.tools.preprocess][INFO] - ===== start preprocess data =====
[2022-09-10 17:14:50,946][deepke.relation_extraction.standard.tools.preprocess][INFO] - load raw files...
[2022-09-10 17:14:50,946][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/train.csv
[2022-09-10 17:14:50,949][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/valid.csv
[2022-09-10 17:14:50,949][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/test.csv
[2022-09-10 17:14:50,950][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/relation.csv
[2022-09-10 17:14:50,950][deepke.relation_extraction.standard.tools.preprocess][INFO] - clean data...
[2022-09-10 17:14:50,953][deepke.relation_extraction.standard.tools.preprocess][INFO] - convert relation into index...
[2022-09-10 17:14:50,953][deepke.relation_extraction.standard.tools.preprocess][INFO] - verify whether use pretrained language models...
[2022-09-10 17:14:50,954][deepke.relation_extraction.standard.tools.preprocess][INFO] - serialize sentence into tokens...
[2022-09-10 17:14:52,399][deepke.relation_extraction.standard.tools.preprocess][INFO] - build vocabulary...
[2022-09-10 17:14:52,421][deepke.relation_extraction.standard.tools.vocab][INFO] - vocab after be trimmed, keep words [436 / 561] = 77.72%
[2022-09-10 17:14:52,426][deepke.relation_extraction.standard.tools.preprocess][INFO] - convert tokens into index...
[2022-09-10 17:14:52,429][deepke.relation_extraction.standard.tools.preprocess][INFO] - build position sequence...
[2022-09-10 17:14:52,523][deepke.relation_extraction.standard.tools.preprocess][INFO] - save data for backup...
[2022-09-10 17:14:52,523][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/train.pkl
[2022-09-10 17:14:52,529][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/valid.pkl
[2022-09-10 17:14:52,530][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/test.pkl
[2022-09-10 17:14:52,531][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/vocab.pkl
[2022-09-10 17:14:52,531][deepke.relation_extraction.standard.tools.preprocess][INFO] - save vocab in txt file, for watching...
[2022-09-10 17:14:52,531][deepke.relation_extraction.standard.tools.preprocess][INFO] - ===== end preprocess data =====
[2022-09-10 17:14:52,533][deepke.relation_extraction.standard.utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/vocab.pkl
[2022-09-10 17:14:52,533][utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/train.pkl
[2022-09-10 17:14:52,538][utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/valid.pkl
[2022-09-10 17:14:52,539][utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/test.pkl
[2022-09-10 17:14:55,866][__main__][INFO] - 
 Capsule(
  (embedding): Embedding(
    (wordEmbed): Embedding(445, 60, padding_idx=0)
    (entityPosEmbed): Embedding(122, 60, padding_idx=0)
    (attribute_keyPosEmbed): Embedding(122, 60, padding_idx=0)
    (layer_norm): LayerNorm((60,), eps=1e-05, elementwise_affine=True)
  )
  (cnn): CNN(
    (convs): ModuleList(
      (0): Conv1d(60, 100, kernel_size=(9,), stride=(1,), bias=False)
    )
    (activations): ModuleDict(
      (relu): ReLU()
      (lrelu): LeakyReLU(negative_slope=0.01)
      (prelu): PReLU(num_parameters=1)
      (selu): SELU()
      (celu): CELU(alpha=1.0)
      (gelu): GELU()
      (sigmoid): Sigmoid()
      (tanh): Tanh()
    )
    (dropout): Dropout(p=0.3, inplace=False)
  )
  (capsule): Capsule()
)
[2022-09-10 17:14:55,866][__main__][INFO] - ========== Start training ==========
