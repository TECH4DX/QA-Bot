[2022-09-12 17:59:43,911][__main__][INFO] - 
cwd: /home/zzx/deepke/DeepKE/example/re/standard
preprocess: true
data_path: data/origin
out_path: data/out
chinese_split: true
replace_entity_with_type: true
replace_entity_with_scope: true
min_freq: 3
pos_limit: 30
seed: 1
use_gpu: true
gpu_id: 0
epoch: 150
batch_size: 32
learning_rate: 0.0003
lr_factor: 0.7
lr_patience: 3
weight_decay: 0.001
early_stopping_patience: 6
train_log: true
log_interval: 10
show_plot: true
only_comparison_plot: false
plot_utils: matplot
predict_plot: false
vocab_size: ???
word_dim: 60
pos_size: 62
pos_dim: 10
dim_strategy: sum
num_relations: 15
fp: /home/zzx/deepke/DeepKE/example/re/standard/checkpoints/2022-09-10_17-22-56/lm_epoch150.pth
model_name: capsule
share_weights: true
num_iterations: 5
dropout: 0.3
input_dim_capsule: ???
dim_capsule: 50
num_capsule: ???
in_channels: ???
out_channels: 100
kernel_sizes:
- 9
activation: lrelu
keep_length: false
pooling_strategy: cls

[2022-09-12 17:59:51,456][__main__][INFO] - device: cuda:0
[2022-09-12 17:59:51,456][deepke.relation_extraction.standard.tools.preprocess][INFO] - ===== start preprocess data =====
[2022-09-12 17:59:51,456][deepke.relation_extraction.standard.tools.preprocess][INFO] - load raw files...
[2022-09-12 17:59:51,456][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/train.csv
[2022-09-12 17:59:51,459][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/valid.csv
[2022-09-12 17:59:51,460][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/test.csv
[2022-09-12 17:59:51,461][utils.ioUtils][INFO] - load csv from /home/zzx/deepke/DeepKE/example/re/standard/data/origin/relation.csv
[2022-09-12 17:59:51,461][deepke.relation_extraction.standard.tools.preprocess][INFO] - clean data...
[2022-09-12 17:59:51,464][deepke.relation_extraction.standard.tools.preprocess][INFO] - convert relation into index...
[2022-09-12 17:59:51,464][deepke.relation_extraction.standard.tools.preprocess][INFO] - verify whether use pretrained language models...
[2022-09-12 17:59:51,465][deepke.relation_extraction.standard.tools.preprocess][INFO] - serialize sentence into tokens...
[2022-09-12 17:59:52,785][deepke.relation_extraction.standard.tools.preprocess][INFO] - build vocabulary...
[2022-09-12 17:59:52,808][deepke.relation_extraction.standard.tools.vocab][INFO] - vocab after be trimmed, keep words [436 / 561] = 77.72%
[2022-09-12 17:59:52,818][deepke.relation_extraction.standard.tools.preprocess][INFO] - convert tokens into index...
[2022-09-12 17:59:52,826][deepke.relation_extraction.standard.tools.preprocess][INFO] - build position sequence...
[2022-09-12 17:59:52,944][deepke.relation_extraction.standard.tools.preprocess][INFO] - save data for backup...
[2022-09-12 17:59:52,944][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/train.pkl
[2022-09-12 17:59:52,950][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/valid.pkl
[2022-09-12 17:59:52,951][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/test.pkl
[2022-09-12 17:59:52,952][utils.ioUtils][INFO] - save data in /home/zzx/deepke/DeepKE/example/re/standard/data/out/vocab.pkl
[2022-09-12 17:59:52,953][deepke.relation_extraction.standard.tools.preprocess][INFO] - save vocab in txt file, for watching...
[2022-09-12 17:59:52,953][deepke.relation_extraction.standard.tools.preprocess][INFO] - ===== end preprocess data =====
[2022-09-12 17:59:52,954][deepke.relation_extraction.standard.utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/vocab.pkl
[2022-09-12 17:59:52,955][utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/train.pkl
[2022-09-12 17:59:52,959][utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/valid.pkl
[2022-09-12 17:59:52,960][utils.ioUtils][INFO] - load data from /home/zzx/deepke/DeepKE/example/re/standard/data/out/test.pkl
[2022-09-12 17:59:56,314][__main__][INFO] - 
 Capsule(
  (embedding): Embedding(
    (wordEmbed): Embedding(445, 60, padding_idx=0)
    (entityPosEmbed): Embedding(62, 60, padding_idx=0)
    (attribute_keyPosEmbed): Embedding(62, 60, padding_idx=0)
    (layer_norm): LayerNorm((60,), eps=1e-05, elementwise_affine=True)
  )
  (cnn): CNN(
    (convs): ModuleList(
      (0): Conv1d(60, 100, kernel_size=(9,), stride=(1,), bias=False)
    )
    (activations): ModuleDict(
      (relu): ReLU()
      (lrelu): LeakyReLU(negative_slope=0.01)
      (prelu): PReLU(num_parameters=1)
      (selu): SELU()
      (celu): CELU(alpha=1.0)
      (gelu): GELU()
      (sigmoid): Sigmoid()
      (tanh): Tanh()
    )
    (dropout): Dropout(p=0.3, inplace=False)
  )
  (capsule): Capsule()
)
[2022-09-12 17:59:56,314][__main__][INFO] - ========== Start training ==========
[2022-09-12 17:59:56,476][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 1: [320/577 (55%)]	Loss: 0.619196
[2022-09-12 17:59:56,476][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 1: Acc: 18.75%	macro metrics: [p: 0.1351, r:0.0940, f1:0.0715]
[2022-09-12 17:59:56,580][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 1: [577/577 (100%)]	Loss: 0.789669
[2022-09-12 17:59:56,581][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 1: Acc: 21.49%	macro metrics: [p: 0.0761, r:0.0920, f1:0.0687]
[2022-09-12 17:59:56,619][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 1: [93/93](100%)	 Loss: 0.563204
[2022-09-12 17:59:56,619][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 1: Acc: 25.81%	macro metrics: [p: 0.1522, r:0.1433, f1:0.1032]
[2022-09-12 17:59:56,747][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 2: [320/577 (55%)]	Loss: 0.489194
[2022-09-12 17:59:56,747][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 2: Acc: 31.87%	macro metrics: [p: 0.2043, r:0.1405, f1:0.1102]
[2022-09-12 17:59:56,855][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 2: [577/577 (100%)]	Loss: 0.697122
[2022-09-12 17:59:56,856][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 2: Acc: 31.02%	macro metrics: [p: 0.2277, r:0.1558, f1:0.1354]
[2022-09-12 17:59:56,881][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 2: [93/93](100%)	 Loss: 0.455692
[2022-09-12 17:59:56,881][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 2: Acc: 48.39%	macro metrics: [p: 0.2403, r:0.3140, f1:0.2481]
[2022-09-12 17:59:57,009][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 3: [320/577 (55%)]	Loss: 0.501439
[2022-09-12 17:59:57,009][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 3: Acc: 35.62%	macro metrics: [p: 0.3707, r:0.2615, f1:0.2249]
[2022-09-12 17:59:57,110][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 3: [577/577 (100%)]	Loss: 0.509801
[2022-09-12 17:59:57,111][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 3: Acc: 40.21%	macro metrics: [p: 0.4327, r:0.2828, f1:0.2744]
[2022-09-12 17:59:57,133][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 3: [93/93](100%)	 Loss: 0.389543
[2022-09-12 17:59:57,133][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 3: Acc: 51.61%	macro metrics: [p: 0.4904, r:0.4538, f1:0.3940]
[2022-09-12 17:59:57,264][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 4: [320/577 (55%)]	Loss: 0.386222
[2022-09-12 17:59:57,264][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 4: Acc: 45.00%	macro metrics: [p: 0.5302, r:0.3695, f1:0.3596]
[2022-09-12 17:59:57,371][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 4: [577/577 (100%)]	Loss: 0.423562
[2022-09-12 17:59:57,371][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 4: Acc: 49.22%	macro metrics: [p: 0.4958, r:0.3826, f1:0.3748]
[2022-09-12 17:59:57,398][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 4: [93/93](100%)	 Loss: 0.337285
[2022-09-12 17:59:57,398][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 4: Acc: 61.29%	macro metrics: [p: 0.4670, r:0.4778, f1:0.4485]
[2022-09-12 17:59:57,527][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 5: [320/577 (55%)]	Loss: 0.347417
[2022-09-12 17:59:57,528][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 5: Acc: 58.75%	macro metrics: [p: 0.6451, r:0.4583, f1:0.4524]
[2022-09-12 17:59:57,632][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 5: [577/577 (100%)]	Loss: 0.353965
[2022-09-12 17:59:57,633][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 5: Acc: 59.45%	macro metrics: [p: 0.6458, r:0.4574, f1:0.4534]
[2022-09-12 17:59:57,654][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 5: [93/93](100%)	 Loss: 0.307701
[2022-09-12 17:59:57,654][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 5: Acc: 74.19%	macro metrics: [p: 0.6159, r:0.6461, f1:0.6077]
[2022-09-12 17:59:57,789][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 6: [320/577 (55%)]	Loss: 0.279891
[2022-09-12 17:59:57,789][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 6: Acc: 70.31%	macro metrics: [p: 0.8336, r:0.5813, f1:0.5890]
[2022-09-12 17:59:57,899][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 6: [577/577 (100%)]	Loss: 0.000000
[2022-09-12 17:59:57,900][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 6: Acc: 72.44%	macro metrics: [p: 0.8357, r:0.6396, f1:0.6585]
[2022-09-12 17:59:57,922][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 6: [93/93](100%)	 Loss: 0.254945
[2022-09-12 17:59:57,922][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 6: Acc: 73.12%	macro metrics: [p: 0.6093, r:0.6187, f1:0.5831]
[2022-09-12 17:59:58,046][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 7: [320/577 (55%)]	Loss: 0.175361
[2022-09-12 17:59:58,046][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 7: Acc: 76.56%	macro metrics: [p: 0.8263, r:0.6687, f1:0.6962]
[2022-09-12 17:59:58,156][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 7: [577/577 (100%)]	Loss: 0.230178
[2022-09-12 17:59:58,156][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 7: Acc: 78.34%	macro metrics: [p: 0.8510, r:0.6960, f1:0.7238]
[2022-09-12 17:59:58,178][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 7: [93/93](100%)	 Loss: 0.211528
[2022-09-12 17:59:58,178][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 7: Acc: 77.42%	macro metrics: [p: 0.6910, r:0.6616, f1:0.6400]
[2022-09-12 17:59:58,305][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 8: [320/577 (55%)]	Loss: 0.139312
[2022-09-12 17:59:58,305][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 8: Acc: 72.19%	macro metrics: [p: 0.8304, r:0.6499, f1:0.6723]
[2022-09-12 17:59:58,415][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 8: [577/577 (100%)]	Loss: 0.104044
[2022-09-12 17:59:58,415][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 8: Acc: 77.82%	macro metrics: [p: 0.8592, r:0.7193, f1:0.7462]
[2022-09-12 17:59:58,437][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 8: [93/93](100%)	 Loss: 0.179937
[2022-09-12 17:59:58,438][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 8: Acc: 84.95%	macro metrics: [p: 0.7832, r:0.7333, f1:0.7019]
[2022-09-12 17:59:58,563][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 9: [320/577 (55%)]	Loss: 0.084145
[2022-09-12 17:59:58,563][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 9: Acc: 88.12%	macro metrics: [p: 0.9203, r:0.8450, f1:0.8625]
[2022-09-12 17:59:58,672][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 9: [577/577 (100%)]	Loss: 0.794708
[2022-09-12 17:59:58,672][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 9: Acc: 88.39%	macro metrics: [p: 0.9247, r:0.8542, f1:0.8742]
[2022-09-12 17:59:58,694][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 9: [93/93](100%)	 Loss: 0.163297
[2022-09-12 17:59:58,695][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 9: Acc: 83.87%	macro metrics: [p: 0.7453, r:0.7294, f1:0.7031]
[2022-09-12 17:59:58,822][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 10: [320/577 (55%)]	Loss: 0.112149
[2022-09-12 17:59:58,822][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 10: Acc: 93.12%	macro metrics: [p: 0.9374, r:0.9343, f1:0.9353]
[2022-09-12 17:59:58,934][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 10: [577/577 (100%)]	Loss: 0.021494
[2022-09-12 17:59:58,934][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 10: Acc: 92.20%	macro metrics: [p: 0.9279, r:0.9138, f1:0.9178]
[2022-09-12 17:59:58,956][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 10: [93/93](100%)	 Loss: 0.130044
[2022-09-12 17:59:58,956][deepke.relation_extraction.standard.tools.trainer][INFO] - Valid Epoch 10: Acc: 87.10%	macro metrics: [p: 0.7700, r:0.7646, f1:0.7412]
[2022-09-12 17:59:59,081][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 11: [320/577 (55%)]	Loss: 0.104344
[2022-09-12 17:59:59,081][deepke.relation_extraction.standard.tools.trainer][INFO] - Train Epoch 11: Acc: 93.44%	macro metrics: [p: 0.9371, r:0.9203, f1:0.9276]
